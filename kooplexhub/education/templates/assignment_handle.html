{% extends "assignment.html" %}

{% load render_table from django_tables2 %}
{% load extras %}

{% block assignment_content %}
<div class="tab-pane fade {% if active == "handle" %}show active{% endif %}" id="Assignment" role="tabpanel" aria-labelledby="tab-handle">
  <div class="mt-3">
    {% if d_course_assignments|length > 0 %}
      <form id='assignment-form-handle' style="margin-top: -8px;" class="mt-1 mb-4" action="{% url 'education:assignment_teacher' %}" method="post">
        {% csrf_token %}
        <div class="d-flex flex-row mb-2 mt-2">
          <div class="p-2 mt-1">
            <span data-toggle="tooltip" title="Select assignment you'd like to handle"><i class="bi bi-pencil"></i>&nbsp;Assignment</span>
          </div>
          <div class="p-2 flex-fill">
            <select class="form-select" id="assignment_selected" name="assignment_selected">
              {% for c_id, ass in d_course_assignments.items %}
                {% with ass|first as a0 %}
                <optgroup label="Course {{ a0.course.name }}"> 
                {% for a in ass %}
                  <option class="dropdown-item" value="{{ a.id }}"
                    {% if c.id == courses %} selected {% endif %}
                  >{{ a.name }} ({{ a0.course.folder }}/{{ a.folder }})</option>
                {% endfor %}
                </optgroup>
                {% endwith %}
              {% endfor %}
            </select>
          </div>
        </div>
      </form>
    {% else %}
      {% include 'empty.html' with empty_body='You have not defined any assignments yet.' skip_border=True %}
    {% endif %}
    <form id='assignment-form-mass' class="mb-3 mt-3" action="{% url 'education:handle_mass' %}" method="post">
      {% csrf_token %}
      {% title_with_button "Mass operation" %}
      {% for a_id, t in t_mass.items %}
        <div id="operationPanelMass-{{ a_id }}">
          {% render_table t %}
        </div>
      {% endfor %}
    </form>
    <form  id='assignment-form-individual' class="mb-3 mt-3" action="{% url 'education:handleassigment' %}" method="post">
      {% title_with_button "Individual operation" %}
      <input class="form-control me-2 mb-3 mt-3" type="text" id="search_student" placeholder="Search student by name or username" title="Type in a name">
      {% csrf_token %}
      {% for a_id, t in t_assignments.items %}
        <div id="operationPanelIndividual-{{ a_id }}">
          {% render_table t %}
        </div>
      {% endfor %}
    </form>
  </div>
</div>
{% endblock %}
