{% extends "manual/submenus.html" %}

{% block main_content_center %}
<div class="jumbotron jumbotron-fluid">
  <div class="container">
    <h1 class="display-6">Reports</h1>
    <p class="lead">Static or interactive</p>

    Reports can be either <em>private</em> or <em>public</em>.
<ul>
	<li>private: only registered users are allowed to open it</li>
	<li>public: it is visble to the public without logging in to Kooplex</li>
</ul>
There are three types of reports currently supported in Kooplex:
<ul>
	<li><a href="#static">Static or self-contained interactive HTML pages</a></li>
	<li>Interactive pages hosted by either <a href="#bokeh">bokeh</a> or the <a href="#kg">jupyter-kernelgateway</a></li>
	<li><a href="rest">REST services running in jupyter notebooks.</a></li>
</ul>

Reports should be prepared in the <code>/report/_prepare/</code> directory. 
From the <code>Hub -> Reports</code> dropdown menu you can create a new report, from the folders of <code>/report/_prepare/</code>. 
The whole directory will be saved into the <code>/report</code> directory as read-only. One report can have many versions and each snapshot will have a timstamp.  
<br>
        <img src="/static/content/manual/make-report.png" class="center" height=250px>
<br>
In order to secure the content one can use a password. This way it possible to show plots or any other results to non-registered people but keep the content still confidential.
<br>
<br>
<p class="lead" id="static"> Html reports </p>
For this you should choose <em>Static content served by an nginx server</em>. There is always a main html file (<em>index file</em>) but there can be additional files in the same folder, which are used within the main html file. 
<br>
There are many python (or other) modules that will include javascript functions in the html files and enable many interactive tools such as <br>
<ul>
	<li><a href="http://holoviews.org/">Holoviews</a></li>
	<li><a href="https://pivottable.js.org/examples/">Pivottable Js</a></li>
</ul>
<br>
<p class="lead"> Interactive reports </p>

<ul>
	<li>
<p id="bokeh"><a href="https://bokeh.pydata.org/en/latest/docs/user_guide/server.html">Bokeh server</a><br>
(<em>Not yet functional</em>) </p></li>
	<li>
<p id="kg"><a href="https://jupyter-kernel-gateway.readthedocs.io/en/latest/"> 
	jupyter-kernelgateway</a><br>
(<em>Not yet functional</em>)  </p></li>
</ul>

<p class="lead" id="rest">REST services running in jupyter notebooks.</p>
A <a href="https://en.wikipedia.org/wiki/Representational_state_transfer">REST service</a> is basically an application that listens at an url and serves the queries that are addressed towards it.
For example you can trigger one of its function with additional ? and it will return with some data, that can be a number, a list or even an interactive plot 
(see <a href="https://bokeh.pydata.org/en/latest/docs/user_guide/embed.html">bokeh embed</a>).
<p>The specification can be found here <a href="https://github.com/jupyter/jupyter/wiki/Jupyter-Notebook-Server-API">API </a> and these short tutorials  <a href="https://ndres.me/post/jupyter-notebook-rest-api/"> ndres.me </a> and <a href="https://blog.ouseful.info/2017/09/06/building-a-json-api-using-jupyer-notebooks-in-under-5-minutes/">blog.ouseful.info</a> 
worth to take a look at before building our first REST service.</p>

<p class="lead">Preview of interactive reports.</p>
It is advisable to test your report before committing it. <br>
For html files you can use <a href="https://nbconvert.readthedocs.io/en/latest/"><code>jupyter-nbconvert</code></a> in the terminal. If you then click on it in the file browser then you will see the result
There are two scripts <code>preview-bokeh.sh</code> and <code>preview-nb-api.sh</code> for that purpose. Running these scripts in the report's folder will create a preview of it. The scripts will print out the <code>url</code> where your report can be visited.
<br>
Let say $USER is 'wgct0p' and the site is 'https://kooplex.com' then it will be like <code>https://kooplex.com/notebook/wgct0p-projectname-wgct0p/report</code>.

  </div>
</div>
{% endblock %}

