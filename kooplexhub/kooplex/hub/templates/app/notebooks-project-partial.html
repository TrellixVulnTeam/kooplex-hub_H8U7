{% load custom_tags %}

<div class=" col-md-12 col-sm-12 col-xs-12" xmlns="http://www.w3.org/1999/html" xmlns="http://www.w3.org/1999/html"
     xmlns="http://www.w3.org/1999/html">
        <a data-toggle="collapse"  href="#collapse{{ item.id }}" style="text-decoration: none">
        {% if item.id in running  %}
            <div class="panel  panel-success panel-sm">
            <div class="panel-heading ">
               <strong>{{ item.name }}</strong> </h4> Running {% if item.owner_username != user.username %} ( owned by {{ item.owner_username }} ) {%  endif  %}
        {% else %}
            <div class="panel panel-default panel-sm">
            <div class="panel-heading">
               <span> <strong>{{ item.name }}</strong> </span>{% if item.owner_username != user.username %} ( owned by {{ item.owner_username }} ) {%  endif  %}
        {% endif %}

        {% if 'forked_from_project' in item %} : forked from
            <a href="{{ base_url }}/gitlab/{{ item.forked_from_project.path_with_namespace }}" target="_blank">{{ item.forked_from_project.path_with_namespace }}</a>
        {% endif %}
            <span style="padding-left:50px;"> Using image:<strong> {{ item.image }}  </strong></span>
        </a>
            </div>

        <div id="collapse{{ item.id }}" class="panel-collapse collapse">
            <div class="panel-body">

                <div class=" col-md-2 col-sm-2 col-xs-12">
                    {{ item.description }}
                </div>

            <!-- CONTAINER RELATED STUFF -->

                <div class=" col-md-6 col-sm-6 col-xs-12">
                    <div class="row">
                        {% if not publicvar %}
                            {% if item.id in running  %}
                                <a href="{% url 'container-delete' %}?project_id={{ item.id }}" class="btn btn-danger" role="button">
                                <span class="glyphicon glyphicon-remove-circle" aria-hidden="true"></span> Stop</a>

                            {% else %}
                                <!--a role="button" href="{% url 'container-start' %}?project_id={{ item.id }}{% if 'forked_from_project' in item %}&is_forked=True&project_id={{ item.id }}&target_id={{ item.forked_from_project.id }}{% else%}&is_forked=False{% endif %}"-->
                                <a role="button" href="{% url 'container-start' %}?project_id={{ item.id }}">
                                <button role="button" type="button" class="btn btn-success" >
                                    <span class="glyphicon glyphicon-play" aria-hidden="true"></span> Start</button></a>

                            {% endif %}
                        {% endif %}

                        {% if not publicvar %}
                        {% if item.id in running  %}
                            {% resolve sessions item.id as session %}


                            <a href="{{ session.external_url }}" target="_blank" class="btn btn-success" role="button">
                            <span class="glyphicon glyphicon-folder-open" aria-hidden="true"></span> Open</a>
                            <a role="button" href="{% url 'notebooks-publishform' %}?project_id={{ item.id  }}">
                            <button role="button" type="button" class="btn btn-warning">
                                <span class="glyphicon glyphicon-flag" aria-hidden="true"></span> Publish</button></a>
                        {% else %}

                            <button role="button" type="button" class="btn btn-default" data-toggle="tooltip" title="Start container to enable this button" data-placement="top">
                                    <span class="glyphicon glyphicon-folder-open" aria-hidden="true"></span> Open</button>
                            <button role="button" type="button" class="btn btn-default" data-toggle="tooltip" title="Start container to enable this button" data-placement="top">
                                    <span class="glyphicon glyphicon-folder-open" aria-hidden="true"></span> Publish</button>
                        {% endif %}
                        {% endif %}

                    {% if not publicvar %}
                        {% if item.id in running  %}
                            <button type="button" class="btn btn-default" data-toggle="tooltip" title="Stop container to enable this button" data-placement="top">
                            <span class="glyphicon glyphicon-hdd" aria-hidden="true"></span></p></button>
                        {% else %}
                            <button type="button" class="btn btn-info" data-toggle="modal"  data-target="#change-image-{{ item.safename  }}">
                                <span class="glyphicon glyphicon-hdd" aria-hidden="true"></span> Change image </button>
                        {% endif %}


                    {% endif %}
                    </div>
                </div>

            <!-- GIT RELATED STUFF -->

                <div class=" col-md-1 col-sm-1 col-xs-12">
                    {%  if not publicvar %}
                        <div class="row">
                            <a role="button" href="{% url 'notebooks-commitform' %}?project_id={{ item.id }}">
                            <button role="button" type="button" class="btn btn-warning">
                                <span class="glyphicon glyphicon-thumbs-up" aria-hidden="true"></span> Commit</button></a>

                            <!--<button type="button" class="btn btn-warning" data-toggle="modal" data-target="#repo-commit-{{ item.name }}">
                                <span class="glyphicon glyphicon-thumbs-up" aria-hidden="true"></span> Commit </button>
                                 -->


                            {% comment %}
                            <button type="button" class="btn btn-info" data-toggle="modal" data-target="#repo-pull-{{ item.name }}">
                                <span class="glyphicon glyphicon-thumbs-down" aria-hidden="true"></span> Restore</button>
                                {% include 'app/notebooks-revert.html' %}
                            {% endcomment %}
                            <a role="button" href="{% url 'notebooks-revertform' %}?project_id={{ item.id }}">
                            <button role="button" type="button" class="btn btn-info">
                                <span class="glyphicon glyphicon-thumbs-down" aria-hidden="true"></span> Restore</button></a>

                        </div>
                        {% comment %}
                        {%  if  item.forks_count > 0 %}
                            <div class="row">
                            <p> See the opened <a href="{% url 'notebooks-mergerequestlist' %}?itemid={{ item.id }}&path_with_namespace={{ item.path_with_namespace }}" target="_blank">merge requests</a>    </p>
                            </div>
                        {% endif %}
                        {% endcomment %}
                    {% endif %}
                    {% comment %}
                    {%  if publicvar %}
                            <div class="row">
                                {% if item.forkable %}
                                    <a href="{% url 'project-fork' %}?itemid={{ item.id }}" target="_blank"><span class="btn btn-success">
                                        <span class="glyphicon glyphicon-magnet" aria-hidden="true"></span> Fork it</span> </a>
                                {% else %}
                                     <button role="button" type="button" class="btn btn-warning">it has been forked</button>
                                {% endif %}
                            </div>
                    {%  endif %}
                    {% endcomment %}

            </div>

            <!-- PROJECT RELATED STUFF -->

                <div class=" col-md-3 col-sm-3 col-xs-3">
                    {% if not publicvar %}
                        {% comment  %}{% include 'app/notebooks-delete-project.html' %} {% endcomment %}
                        <a href="{% url 'project-members-form' %}?project_id={{ item.id }}" class="btn btn-primary" role="button">
                            <span class="glyphicon glyphicon-user" aria-hidden="true"></span> Members</a>
                        {% if item.id not in running  %}
                            <button type="button" class="btn btn-danger" data-toggle="modal"  data-target="#delete-project-{{ item.id }}">
                            <span class="glyphicon glyphicon-trash" aria-hidden="true"></span> Delete project</button>
                        {% else %}

                            <button type="button" class="btn btn-default" data-toggle="tooltip" title="Stop container to enable this button" data-placement="top">
                            <span class="glyphicon glyphicon-trash" aria-hidden="true"></span> Delete project</button>
                        {% endif %}

                    {% endif %}
                </div>
                {% include 'app/notebooks-change-image.html' %}
                {% include 'app/notebooks-delete-project.html' %}
            </div>
        </div>
        </div>






</div>

