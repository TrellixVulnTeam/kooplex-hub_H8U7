{% extends "app/layout.html" %}

{% block content %}

<!-- <h2>Image creation</h2>-->
{% if username %}
<div class="projects new-project">

{% include 'app/notebooks-new-partial.html' with myprojects=True %}
<p><button type="button" class="btn btn-default" data-toggle="modal" data-target="#project-new">Start new project &raquo;</button></p>

</div>

<div class="projects">
<div class="projects running-containers">
<h2>My running containers</h2>
{% for item in notebooks %}

    <p><span  style="padding-right: 50px;">Container: <b>{{ item.name }}</b></span>
   {% if item.is_stopped %}
            <a href="{% url 'container-start' %}?notebook_id={{ item.id }}&session_id={{ item.id }}"><span class="button start">Start</span></a>
       {%  else %}
            <a href="{% url 'container-stop' %}?notebook_id={{ item.id }}&session_id={{ item.id }}"><span class="button stop">Stop</span></a>
       {% endif %}
       <a href="{% url 'container-delete' %}?notebook_id={{ item.id }}&session_id={{ item.id }}"><span class="button delete">Delete</span></a>
   {% if item.is_stopped %}       
       <b> Container is stopped </b>
   {% else %}
       <b> Container is running </b>
   {% endif %}
   </p>
    {% for session in sessions %}
        {%  if session.container_name == item.name %}
            <div class="session running">
                <p><span  style="padding-right: 50px;"><b>{{ session.notebook_path }}</b></span>
                
                {% if item.is_stopped %}
                   <span class="button  stop">container stopped</span>
                {% else %}
                  <a href="{{ session.external_url }}" target="_blank"><span class="button open">open</span></a>
                {% endif %}
                </p>
                
            {% comment %}
TODO: This will be moved (commit, merge request) to project-partial.html
    {% if notebook_dir_name in item.notebook_path %}
        <!-- This branch will be removed -->
    {% else %}
        <a href="{{ item.external_url }}" target="_blank">open </a>
        {% if item.is_forked %}
            | <a href="{% url 'notebooks-commit' %}?notebook_path_dir={{ item.notebook_path }}&is_forked={{ item.is_forked }}&project_id={{ item.project_id }}&target_id={{ item.target_id }}">
            commit and create merge request</a>
        {% else %}
            | <a href="{% url 'notebooks-commit' %}?notebook_path_dir={{ item.notebook_path }}&is_forked={{ item.is_forked }}">
            commit</a>
        {% endif %}
    {% endif %}
{% endcomment %}
        <!-- | <a href="{% url 'notebooks-shutdown' %}?session_id={{ item.id }}">shut down</a> -->
            </p>
            </div>
        {% endif %}
    {% endfor %}
{% endfor %}
    </div>
<div>

{% comment %} Nem vilagos, hogy hova krealodnak. Majd le sz a projektekhez kulon try gomb...
{% endcomment %}

<div class="projects my">
<h2>My projects</h2>
{% for item in projects %}
    {% include 'app/project-partial.html'  %}
{% endfor %}
</div>
{% endif %}
<div class="projects public">
<h2>Other public projects</h2>
{% for item in public_projects %}
    {% if item.owner.username != username %}
        {% include 'app/project-partial.html' with publicvar=True %}
    {% endif %}
{% endfor %}
</div>
{% endblock %}
