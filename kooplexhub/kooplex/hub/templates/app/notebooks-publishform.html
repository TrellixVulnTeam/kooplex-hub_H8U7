{% extends "app/layout.html" %}

{% block content %}


    <div class="row">
        <div class=" col-md-10 col-sm-10 col-xs-12">

            <div class="panel panel-default ">
                <div class="panel-heading">
                    <h2>Publish your work</h2>
                    <h4>Convert notebooks to <strong>html</strong> or create <strong>dashboard</strong></h4>
                </div>
                <div class="panel-body">

                    <section id="toconvertForm">
                        <form action="{% url 'notebooks-convert-html' %}" method="post" class="form-horizontal" onsubmit="collectCheckedElements()">
                        {% csrf_token %}
                        <div style="padding-left: 20px;">
                        <div class="well"> <strong>Notebooks</strong> These notebooks will be converted to html and accessible in the <a href="/hub/worksheets" target="_blank" >Reports</a> section</div>
                        <div class="form-group">
                            {% for item in ipynbs %}
                                <input type="radio" name="ipynb_file" value="{{ item }}" {% if forloop.first %} checked {% endif %} > {{ item }}<br>
                            {% endfor %}
                        </div>
                        <div class="well"> <strong>Data files</strong> These files will be copied next to the deployed notebooks</div>
                        <div class="form-group">
                            {% for item in other_files %}
                                <input type="checkbox" name="other_files" value="{{ item }}"> {{ item }}<br>
                            {% endfor %}
                        </div>
                        <div class="form-group">
                            <div class="col-md-offset-2 col-md-10">
                        <select name = "scope" class = "btn btn-default">
                            <option value="private">private</option>
                            <option value="internal">internal</option>
                            <option value="public">public</option>
                        </select>
                                <input type="hidden" name="project_id" value="{{ project_id }}" />
                                <input type="hidden" name="toconvert_files" value="" />

                                <input type="submit" name="html" value="Convert to html" class="btn btn-default" />
                                <input type="submit" name="dashboard" value="Deploy as dashboard" class="btn btn-default" />
                            </div>
                        </div>
                        </div>
                        </form>
                    </section>
                </div>
            </div>

        </div>
        </div>

    <script>
        function collectCheckedElements() {
            var inputs = document.getElementsByTagName("input");
            var other_files = "'"
            for (var i = 1; i < inputs.length; i++) {
                if (inputs[i].type == "checkbox") {
                    if (inputs[i].name == "other_files") {
                        if (inputs[i].checked) {
                            other_files += inputs[i].value + ",";
                        }

                    }
                }
            }
            if(other_files.length > 0) {
                other_files = other_files.substring(1, other_files.length - 1);
            }
            document.getElementsByName("other_files")[0].value = other_files;
        }
    </script>

{% endblock %}
